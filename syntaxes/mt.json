{
  "name": "Embedded JavaScript (mojo.js)",
  "scopeName": "text.html.mt",
  "fileTypes": ["html.mt"],
  "injections": {
    "text.html.mt": {
      "patterns": [
        {
          "begin": "(^\\s*)(?=<%#(?![^%]*%>))",
          "beginCaptures": {
            "0": {
              "name": "punctuation.whitespace.comment.leading.mt"
            }
          },
          "end": "(?!\\G)(\\s*$\\n)?",
          "endCaptures": {
            "0": {
              "name": "punctuation.whitespace.comment.trailing.mt"
            }
          },
          "patterns": [
            {
              "include": "#comment"
            }
          ]
        },
        {
          "begin": "(^\\s*)(?=<%%(?![^%]*%>))",
          "beginCaptures": {
            "0": {
              "name": "punctuation.whitespace.replacement.leading.mt"
            }
          },
          "end": "(?!\\G)(\\s*$\\n)?",
          "endCaptures": {
            "0": {
              "name": "punctuation.whitespace.replacement.trailing.mt"
            }
          },
          "patterns": [
            {
              "include": "#replacement"
            }
          ]
        },
        { "include": "#replacement" },
        {
          "begin": "(^\\s*)(?=<%(?![^%]*%>))",
          "beginCaptures": {
            "0": {
              "name": "punctuation.whitespace.embedded.leading.mt"
            }
          },
          "end": "(?!\\G)(\\s*$\\n)?",
          "endCaptures": {
            "0": {
              "name": "punctuation.whitespace.embedded.trailing.mt"
            }
          },
          "patterns": [
            {
              "include": "#tags"
            }
          ]
        },
        {
          "include": "#comment"
        },
        {
          "include": "#lines"
        },
        {
          "include": "#tags"
        },
        {
          "include": "#blocks"
        }
      ]
    }
  },
  "patterns": [
    {
      "include": "text.html.basic"
    }
  ],
  "repository": {
    "comment": {
      "patterns": [
        {
          "begin": "<%#",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.comment.begin.mt"
            }
          },
          "end": "%>",
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.comment.end.mt"
            }
          },
          "name": "comment.block.mt"
        }
      ]
    },
    "lines": {
      "patterns": [
        {
          "begin": "(?<=\\s{2})(%#)",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.comment.indented.line.mt"
            }
          },
          "end": "$",
          "name": "comment.line.mt.indented"
        },
        {
          "begin": "^(%#)",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.comment.line.mt"
            }
          },
          "end": "$",
          "name": "comment.line.mt"
        },
        {
          "begin": "(?<=\\s{2})(%={,2})",
          "beginCaptures": {
            "0": {
              "name": "punctuation.section.embedded.indented.line.mt"
            }
          },
          "contentName": "source.js",
          "end": "$",
          "name": "source.js.mt.indented",
          "patterns": [
            {
              "include": "source.js"
            }
          ]
        },
        {
          "begin": "^(%={,2})",
          "beginCaptures": {
            "0": {
              "name": "punctuation.section.embedded.line.mt"
            }
          },
          "end": "$",
          "name": "source.js.mt.line",
          "patterns": [
            {
              "include": "source.js"
            }
          ]
        }
      ]
    },
    "replacement": {
      "patterns": [
        {
          "begin": "<%%",
          "beginCaptures": {
            "0": {
              "name": "punctuation.section.embedded.begin.mt"
            }
          },
          "contentName": "punctuation.whitespace.replacement.mt",
          "end": "%>",
          "endCaptures": {
            "0": {
              "name": "punctuation.section.embedded.end.mt"
            },
            "1": {
              "name": "text.html.basic"
            }
          }
        },
        {
          "match": "(%%)",
          "captures": {
            "0": {
              "name": "punctuation.section.embedded.replacement.mt"
            }
          }
        }
      ]
    },
    "tags": {
      "patterns": [
        {
          "begin": "<%(?!>)={,2}(?![^%]*=?%>)",
          "beginCaptures": {
            "0": {
              "name": "punctuation.section.embedded.begin.mt"
            }
          },
          "contentName": "source.js",
          "end": "=?%>",
          "endCaptures": {
            "0": {
              "name": "punctuation.section.embedded.end.mt"
            },
            "1": {
              "name": "source.js"
            }
          },
          "name": "text.html.mt.block",
          "patterns": [
            {
              "include": "source.js"
            }
          ]
        },
        {
          "begin": "<%(?!>)={,2}",
          "beginCaptures": {
            "0": {
              "name": "punctuation.section.embedded.begin.mt"
            }
          },
          "contentName": "source.js",
          "end": "=?%>",
          "endCaptures": {
            "0": {
              "name": "punctuation.section.embedded.end.mt"
            },
            "1": {
              "name": "source.js"
            }
          },
          "name": "text.html.mt.line",
          "patterns": [
            {
              "include": "source.js"
            }
          ]
        }
      ]
    },
    "blocks": {
      "patterns": [
        {
          "begin": "<{",
          "beginCaptures": {
            "0": {
              "name": "punctuation.section.embedded.begin.mt"
            }
          },
          "contentName": "punctuation.whitespace.replacement.mt",
          "end": "}>",
          "endCaptures": {
            "0": {
              "name": "punctuation.section.embedded.end.mt"
            },
            "1": {
              "name": "text"
            }
          }
        }
      ]
    }
  }
}
